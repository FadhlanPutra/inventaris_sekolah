<?php

namespace App\Http\Middleware;

use Illuminate\Http\Middleware\TrustProxies as Middleware;
use Symfony\Component\HttpFoundation\Request;

class TrustProxies extends Middleware
{
    protected $proxies = [
        '127.0.0.1',
        '::1',
        'localhost',
        // Cloudflare IP ranges
        '173.245.48.0/20',
        '103.21.244.0/22',
        '103.22.200.0/22',
        '103.31.4.0/22',
        '141.101.64.0/18',
        '108.162.192.0/18',
        '190.93.240.0/20',
        '188.114.96.0/20',
        '197.234.240.0/22',
        '198.41.128.0/17',
        '162.158.0.0/15',
        '104.16.0.0/13',
        '104.24.0.0/14',
        '172.64.0.0/13',
        '131.0.72.0/22',
        // Additional Cloudflare IP ranges (2024)
        '104.16.0.0/12',
        '104.24.0.0/14',
        '104.28.0.0/16',
        '104.29.0.0/16',
        '104.30.0.0/16',
        '104.31.0.0/16',
        '108.162.192.0/18',
        '108.162.193.0/24',
        '108.162.194.0/24',
        '108.162.195.0/24',
        '108.162.196.0/24',
        '108.162.197.0/24',
        '108.162.198.0/24',
        '108.162.199.0/24',
        '108.162.200.0/24',
        '108.162.201.0/24',
        '108.162.202.0/24',
        '108.162.203.0/24',
        '108.162.204.0/24',
        '108.162.205.0/24',
        '108.162.206.0/24',
        '108.162.207.0/24',
        '108.162.208.0/24',
        '108.162.209.0/24',
        '108.162.210.0/24',
        '108.162.211.0/24',
        '108.162.212.0/24',
        '108.162.213.0/24',
        '108.162.214.0/24',
        '108.162.215.0/24',
        '108.162.216.0/24',
        '108.162.217.0/24',
        '108.162.218.0/24',
        '108.162.219.0/24',
        '108.162.220.0/24',
        '108.162.221.0/24',
        '108.162.222.0/24',
        '108.162.223.0/24',
    ];

    protected $headers =
        Request::HEADER_X_FORWARDED_FOR |
        Request::HEADER_X_FORWARDED_HOST |
        Request::HEADER_X_FORWARDED_PORT |
        Request::HEADER_X_FORWARDED_PROTO |
        Request::HEADER_X_FORWARDED_AWS_ELB;
}
